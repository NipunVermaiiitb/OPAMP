Version 4
SHEET 1 3004 2024
WIRE 576 -240 528 -240
WIRE 800 -240 576 -240
WIRE 528 -224 528 -240
WIRE 800 -112 800 -160
WIRE 528 -80 528 -144
WIRE 528 -80 448 -80
WIRE 800 -64 800 -112
WIRE 528 -32 528 -80
WIRE -96 -16 -96 -48
WIRE 0 0 0 -48
WIRE 528 0 528 -32
WIRE -96 16 -96 -16
WIRE 0 48 0 0
WIRE 96 48 96 16
WIRE 96 80 96 48
WIRE 528 96 528 80
WIRE 800 96 800 16
WIRE 800 96 528 96
WIRE 528 112 528 96
WIRE -96 192 -96 96
WIRE 0 192 0 128
WIRE 0 192 -96 192
WIRE 96 192 96 160
WIRE 96 192 0 192
WIRE 224 192 96 192
WIRE 224 224 224 192
FLAG 224 224 0
FLAG -96 -16 VDD
FLAG 0 0 VSS
FLAG 96 48 VINP
FLAG 528 112 0
FLAG 528 -32 VOUT
FLAG 576 -240 FB_TOP
FLAG 800 -112 VINN
SYMBOL voltage 96 64 R0
WINDOW 123 24 124 Left 2
WINDOW 39 0 0 Left 0
SYMATTR Value2 AC 1
SYMATTR InstName V1
SYMATTR Value PULSE(0 1 10n 1n 1n 1u 2u)
SYMBOL voltage 0 32 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName Vss
SYMATTR Value -5
SYMBOL voltage -96 0 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName Vdd
SYMATTR Value 5
SYMBOL res 512 -240 R0
SYMATTR InstName Rf
SYMATTR Value {Rf_nom}
SYMBOL res 784 -80 R0
SYMATTR InstName Rg
SYMATTR Value {Rg_nom}
SYMBOL res 512 -16 R0
SYMATTR InstName Rload
SYMATTR Value 10k
SYMBOL voltage 800 -256 R0
WINDOW 123 24 44 Left 2
WINDOW 39 0 0 Left 0
SYMATTR Value2 AC 0
SYMATTR InstName Vinj
SYMATTR Value 0
TEXT 984 -248 Left 2 !* OpAmpWars harness\n.param Rg_nom=1k\n.param Rf_nom=99k\n \n* Rails\n*VDDsrc VDD 0 DC 5\n*VSSsrc VSS 0 DC -5\n \n* Input\n*Vinp VINP 0 PULSE(0 1 10n 1n 1n 1u 2u) AC 1\n \n* Feedback network\n*Rload VOUT 0 10k\n*Rfb   VOUT FB_TOP {Rf_nom}\n*Vinj  FB_TOP VINN DC 0 AC 0\n*Rg    VINN 0 {Rg_nom}\n \n* MOS models\n.model nmos4 NMOS (LEVEL=1 VTO=0.45 KP=120u LAMBDA=0.02)\n.model pmos4 PMOS (LEVEL=1 VTO=-0.45 KP=50u  LAMBDA=0.02)\n \n* Amplifier\n.include my_opamp_lp.sub\nXAMP VINP VINN VOUT VDD VSS my_opamp_lp\n \n* Simulations\n.ac dec 100 10 100Meg\n.tran 0 500u 0 10n\n.step param run 1 20 1\n \n* Measurements (optional)\n.meas AC Av_mag_1k FIND mag(V(VOUT)/V(VINP)) WHEN frequency=1k\n.meas AC Av_db_1k PARAM 20*log10(Av_mag_1k)\n.meas TRAN SR_RISE MAX deriv(V(VOUT))\n.meas TRAN SR_FALL MIN deriv(V(VOUT))\n.meas TRAN Vos_out FIND V(VOUT) AT=1u\n \n.end
TEXT 128 608 Left 2 !.include my_opamp_lp.sub\nXAMP VINP VINN VOUT VDD VSS my_opamp_lp
